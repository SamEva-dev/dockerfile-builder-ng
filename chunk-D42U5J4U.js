import{a as ce,b as de}from"./chunk-MJQ3KY2W.js";import{a as Q,b as Z,c as $}from"./chunk-ZXMRF2QA.js";import"./chunk-NNZJJLOA.js";import{a as ee,b as te,c as se,d as le,e as pe}from"./chunk-UHGY6NSJ.js";import{a as j,b as ae}from"./chunk-YUABFYP2.js";import{c as G,d as Y,e as K,f as q,g as J,i as ne,j as ie,k as re,l as oe}from"./chunk-X2UVP5SW.js";import"./chunk-G2M2UXHZ.js";import"./chunk-HEVQ3NIT.js";import"./chunk-Z7WK5Y2H.js";import{b as N}from"./chunk-6LZFZSYY.js";import{Da as z,S as W,Ua as X,Va as H,h as B,i as V,l as L,w as A,x as F}from"./chunk-2ZZAZF3K.js";import{$ as U,$b as S,Bb as I,Cb as D,Eb as y,Gb as u,Hb as g,Ra as n,Wb as p,Xb as d,Yb as w,_b as E,a as M,ac as P,b as v,bb as k,bc as T,fa as C,ga as x,hb as b,jb as O,jc as s,kc as l,pa as f,pc as R,ub as _,vb as o,wb as i,xb as h}from"./chunk-MXPEK2PN.js";function ue(m,c){m&1&&(h(0,"i",26),p(1),s(2,"translate")),m&2&&(n(),w(" ",l(2,1,"USER.EXEC_TITLE")," "))}function ge(m,c){if(m&1){let e=y();o(0,"span",31),u("click",function(){let t=C(e).$implicit,a=g(2);return x(a.selectedExistingUser()==t)}),p(1),i()}if(m&2){let e=c.$implicit;n(),d(e)}}function _e(m,c){if(m&1){let e=y();I(0),o(1,"div",27)(2,"label"),p(3),s(4,"translate"),i(),o(5,"input",28),s(6,"translate"),u("ngModelChange",function(t){C(e);let a=g();return a.selectedExistingUser.set(t),x(a.updateAllSignals())}),i()(),o(7,"div",29),b(8,ge,2,1,"span",30),i(),D()}if(m&2){let e=g();n(3),d(l(4,4,"USER.EXEC_EXISTING")),n(2),_("ngModel",e.selectedExistingUser())("placeholder",l(6,6,"USER.EXEC_PLACEHOLDER")),n(3),_("ngForOf",e.existingUsers)}}function Ce(m,c){m&1&&(h(0,"i",40),p(1),s(2,"translate")),m&2&&(n(),w(" ",l(2,1,"USER.CREATE_TITLE")," "))}function xe(m,c){if(m&1){let e=y();o(0,"p-card",32),b(1,Ce,3,3,"ng-template",9),o(2,"div",10),p(3),s(4,"translate"),i(),o(5,"div",33)(6,"div",34)(7,"label"),p(8),s(9,"translate"),i(),o(10,"p-select",35),P("ngModelChange",function(t){C(e);let a=g();return S(a.userType,t)||(a.userType=t),x(t)}),u("ngModelChange",function(){C(e);let t=g();return x(t.updateAllSignals())}),i()()(),o(11,"div",33)(12,"div",34)(13,"label"),p(14),s(15,"translate"),i(),o(16,"input",36),P("ngModelChange",function(t){C(e);let a=g();return S(a.username,t)||(a.username=t),x(t)}),u("ngModelChange",function(){C(e);let t=g();return x(t.updateAllSignals())}),i()(),o(17,"div",34)(18,"label"),p(19),s(20,"translate"),i(),o(21,"input",37),u("ngModelChange",function(t){C(e);let a=g();return a.uid.set(t),x(a.updateAllSignals())}),i()(),o(22,"div",34)(23,"label"),p(24),s(25,"translate"),i(),o(26,"input",37),u("ngModelChange",function(t){C(e);let a=g();return a.gid.set(t),x(a.updateAllSignals())}),i()(),o(27,"div",34)(28,"label"),p(29),s(30,"translate"),i(),o(31,"p-select",38),P("ngModelChange",function(t){C(e);let a=g();return S(a.shell,t)||(a.shell=t),x(t)}),u("ngModelChange",function(){C(e);let t=g();return x(t.updateAllSignals())}),i()()(),o(32,"div",33)(33,"div",34)(34,"label"),p(35),s(36,"translate"),i(),o(37,"input",39),P("ngModelChange",function(t){C(e);let a=g();return S(a.home,t)||(a.home=t),x(t)}),u("ngModelChange",function(){C(e);let t=g();return x(t.updateAllSignals())}),i()()()()}if(m&2){let e=g();n(3),d(l(4,17,"USER.CREATE_DESC")),n(5),d(l(9,19,"USER.TYPE")),n(2),_("options",e.userTypes),E("ngModel",e.userType),n(4),d(l(15,21,"USER.USERNAME")),n(2),E("ngModel",e.username),n(3),d(l(20,23,"USER.UID")),n(2),_("ngModel",e.uid())("readonly",e.isDebianUser()),n(3),d(l(25,25,"USER.GID")),n(2),_("ngModel",e.gid())("readonly",e.isDebianUser()),n(3),d(l(30,27,"USER.SHELL")),n(2),_("options",e.shellOptions),E("ngModel",e.shell),n(4),d(l(36,29,"USER.HOME")),n(2),E("ngModel",e.home)}}var me=class m{translate=U(A);dockerService=U(ae);router=U(N);shellOptions=[{label:"/bin/sh (par d\xE9faut)",value:"/bin/sh"},{label:"/bin/bash",value:"/bin/bash"},{label:"zsh",value:"zsh"},{label:"/usr/sbin/nologin (s\xE9curis\xE9)",value:"/usr/sbin/nologin"},{label:"",value:""}];createUser=f(!1);selectedExistingUser=f("");existingUsers=["node","www-data","root"];userTypes=[{label:"Utilisateur r\xE9gulier (Ubuntu/Debian)",value:"debian"},{label:"Utilisateur syst\xE8me (Alpine/BusyBox)",value:"alpine"}];userType=f("alpine");username=f("appuser");uid=f(1001);gid=f(1001);shell=f("/bin/sh");home=f("/home/appuser");previous=new O;next=new O;dockerfilePreview=this.dockerService.dockerfilePreview;dockerComposePreview=this.dockerService.composePreview;dockerRunCommand=this.dockerService.cliPreview;isDebianUser=R(()=>this.userType()==="debian");updateAllSignals(){this.generateFileFromInstructions(),this.generateComposeFromInstructions(),this.generateCommandFromInstructions()}generateFileFromInstructions(){let c=this.dockerService.dockerfile();this.createUser()?this.dockerService.updateDockerfile(v(M({},c||{}),{user:{username:this.username(),uid:this.uid(),gid:this.gid(),type:this.userType(),shell:this.shell(),home:this.home()}})):this.dockerService.updateDockerfile(v(M({},c||{}),{user:{username:this.selectedExistingUser()}}))}generateComposeFromInstructions(){let c=this.dockerService.compose(),e=M({},c?.services||{});e.web=v(M({},e.web),{user:this.createUser()?this.username():this.selectedExistingUser()}),this.dockerService.updateCompose(v(M({},c||{}),{services:e}))}generateCommandFromInstructions(){let c=this.dockerService.cli()||{},e=this.createUser()?this.username():this.selectedExistingUser(),r=this.shell(),t=c.runCommands&&c.runCommands.length>0?c.runCommands.map(a=>v(M({},a),{user:e,shell:r})):[{user:e,shell:r}];this.dockerService.updateCLI(v(M({},c),{runCommands:t}))}onCopyDockerfile(){this.dockerfilePreview&&navigator.clipboard.writeText(this.dockerfilePreview())}onDownloadDockerfile(){if(!this.dockerfilePreview)return;let c=new Blob([this.dockerfilePreview()],{type:"text/plain"}),e=window.URL.createObjectURL(c),r=document.createElement("a");r.href=e,r.download="Dockerfile",r.click(),window.URL.revokeObjectURL(e)}onPrevious(){this.previous.emit(),this.router.navigate(["/volumes"])}onNext(){this.updateAllSignals(),this.next.emit(),this.router.navigate(["/securite"])}static \u0275fac=function(e){return new(e||m)};static \u0275cmp=k({type:m,selectors:[["app-utilisateurs"]],outputs:{previous:"previous",next:"next"},decls:62,vars:50,consts:[[1,"user-step"],[1,"step-content"],[1,"left-side"],[1,"alert-security"],[1,"pi","pi-exclamation-triangle",2,"color","#B03E3D"],[1,"title"],[1,"desc"],[1,"red"],[1,"section-card","user-card"],["pTemplate","title"],[1,"subtitle"],[1,"switch-row"],[3,"ngModelChange","ngModel"],[4,"ngIf"],["class","section-card user-create-card",4,"ngIf"],[1,"section-card","security-tips-card"],[1,"tips-title"],[1,"tips-desc"],[1,"tip","tip-green"],[1,"tip","tip-blue"],[1,"tip","tip-orange"],[1,"bottom-actions"],["icon","pi pi-arrow-left","severity","secondary",1,"nav-btn","nav-btn-prev",3,"click","label"],["icon","pi pi-arrow-right","iconPos","right",1,"nav-btn","nav-btn-next","btn-blue-right",3,"click","label"],[1,"right-side"],[3,"copy","download","content"],[1,"pi","pi-user","mat-icon-bordered-outline"],[1,"existing-user",2,"display","grid"],["pInputText","",3,"ngModelChange","ngModel","placeholder"],[1,"user-suggestions"],["class","suggest-btn",3,"click",4,"ngFor","ngForOf"],[1,"suggest-btn",3,"click"],[1,"section-card","user-create-card"],[1,"form-row"],[1,"form-group"],[3,"ngModelChange","options","ngModel"],["pInputText","","placeholder","appuser",3,"ngModelChange","ngModel"],["pInputText","","type","number",3,"ngModelChange","ngModel","readonly"],["optionLabel","label","optionValue","value","placeholder","sf",3,"ngModelChange","options","ngModel"],["pInputText","","placeholder","/home/appuser",3,"ngModelChange","ngModel"],[1,"pi","pi-user-plus","mat-icon-bordered-outline"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),h(4,"i",4),o(5,"div")(6,"div",5),p(7),s(8,"translate"),i(),o(9,"div",6)(10,"span",7),p(11),s(12,"translate"),i()()()(),o(13,"p-card",8),b(14,ue,3,3,"ng-template",9),o(15,"div",10),p(16),s(17,"translate"),i(),o(18,"div",11)(19,"p-toggleswitch",12),P("ngModelChange",function(a){return S(r.createUser,a)||(r.createUser=a),a}),u("ngModelChange",function(){return r.updateAllSignals()}),i(),o(20,"span"),p(21),s(22,"translate"),i()(),b(23,_e,9,8,"ng-container",13),i(),b(24,xe,38,31,"p-card",14),o(25,"p-card",15)(26,"div",16),p(27),s(28,"translate"),i(),o(29,"div",17),p(30),s(31,"translate"),i(),o(32,"div",18)(33,"b"),p(34),s(35,"translate"),i(),h(36,"br"),p(37),s(38,"translate"),i(),o(39,"div",19)(40,"b"),p(41),s(42,"translate"),i(),h(43,"br"),p(44),s(45,"translate"),i(),o(46,"div",20)(47,"b"),p(48),s(49,"translate"),i(),h(50,"br"),p(51),s(52,"translate"),i()(),o(53,"div",21)(54,"p-button",22),s(55,"translate"),u("click",function(){return r.onPrevious()}),i(),o(56,"p-button",23),s(57,"translate"),u("click",function(){return r.onNext()}),i()()(),o(58,"div",24)(59,"dockerfile-preview",25),u("copy",function(){return r.onCopyDockerfile()})("download",function(){return r.onDownloadDockerfile()}),i(),o(60,"docker-compose-preview",25),u("copy",function(){return r.onCopyDockerfile()})("download",function(){return r.onDownloadDockerfile()}),i(),o(61,"docker-command-preview",25),u("copy",function(){return r.onCopyDockerfile()})("download",function(){return r.onDownloadDockerfile()}),i()()()()),e&2&&(n(7),d(l(8,22,"USER.ALERT_TITLE")),n(4),d(l(12,24,"USER.ALERT_MSG")),n(5),d(l(17,26,"USER.EXEC_DESC")),n(3),E("ngModel",r.createUser),n(2),d(l(22,28,"USER.EXEC_CREATE")),n(2),_("ngIf",!r.createUser()),n(),_("ngIf",r.createUser()),n(3),d(l(28,30,"USER.SECURITY_TITLE")),n(3),d(l(31,32,"USER.SECURITY_DESC")),n(4),d(l(35,34,"USER.TIP_UID")),n(3),w(" ",l(38,36,"USER.TIP_UID_DESC")," "),n(4),d(l(42,38,"USER.TIP_SHELL")),n(3),w(" ",l(45,40,"USER.TIP_SHELL_DESC")," "),n(4),d(l(49,42,"USER.TIP_PERM")),n(3),w(" ",l(52,44,"USER.TIP_PERM_DESC")," "),n(3),_("label",T(l(55,46,"COMMON.BACK_VOLUMES"))),n(2),_("label",T(l(57,48,"COMMON.NEXT_SECURITY"))),n(3),_("content",r.dockerfilePreview()),n(),_("content",r.dockerComposePreview()),n(),_("content",r.dockerRunCommand()))},dependencies:[L,B,V,W,j,Q,Z,te,ee,z,$,J,G,q,Y,K,oe,re,ie,ne,H,X,de,ce,se,le,pe,F],styles:[".user-step[_ngcontent-%COMP%]{width:100%;min-height:100vh;background:#f7fafd}.user-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]{display:flex;gap:30px;max-width:1200px;margin:0 auto;align-items:flex-start}@media (max-width: 1050px){.user-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]{flex-direction:column}}.user-step[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]{flex:1.7;min-width:340px;max-width:540px;display:flex;flex-direction:column;gap:22px}.user-step[_ngcontent-%COMP%]   .right-side[_ngcontent-%COMP%]{flex:2.1;min-width:350px;max-width:650px;gap:10px}.user-step[_ngcontent-%COMP%]   .alert-security[_ngcontent-%COMP%]{background:#fff7ed;border:1.5px solid #f3c893;border-radius:12px;display:flex;gap:18px;align-items:flex-start;padding:18px 22px;margin-bottom:15px}.user-step[_ngcontent-%COMP%]   .alert-security[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:#e1911b;font-size:2rem;margin-right:5px}.user-step[_ngcontent-%COMP%]   .alert-security[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#c36a06;font-weight:600;font-size:1.17rem;margin-bottom:2px}.user-step[_ngcontent-%COMP%]   .alert-security[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]   .red[_ngcontent-%COMP%]{color:#b03400;font-weight:600}.user-step[_ngcontent-%COMP%]   .section-card[_ngcontent-%COMP%]{box-shadow:0 2px 12px #0077ee10;border-radius:14px;margin-bottom:0}.user-step[_ngcontent-%COMP%]   .section-card[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#496ab1;font-size:1rem;margin-bottom:10px}.user-step[_ngcontent-%COMP%]   .section-card[_ngcontent-%COMP%]   .switch-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-bottom:8px}.user-step[_ngcontent-%COMP%]   .section-card[_ngcontent-%COMP%]   .user-suggestions[_ngcontent-%COMP%]{margin-top:8px;display:flex;gap:8px}.user-step[_ngcontent-%COMP%]   .section-card[_ngcontent-%COMP%]   .user-suggestions[_ngcontent-%COMP%]   .suggest-btn[_ngcontent-%COMP%]{background:#e3e8f5;color:#1756ab;border-radius:13px;padding:3px 16px;font-size:1rem;font-weight:600;cursor:pointer;transition:background .15s}.user-step[_ngcontent-%COMP%]   .section-card[_ngcontent-%COMP%]   .user-suggestions[_ngcontent-%COMP%]   .suggest-btn[_ngcontent-%COMP%]:hover{background:#d4e2f9}.user-step[_ngcontent-%COMP%]   .section-card[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{gap:15px;margin-bottom:6px}.user-step[_ngcontent-%COMP%]   .section-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:2px}.user-step[_ngcontent-%COMP%]   .security-tips-card[_ngcontent-%COMP%]{margin-top:14px}.user-step[_ngcontent-%COMP%]   .security-tips-card[_ngcontent-%COMP%]   .tips-title[_ngcontent-%COMP%]{font-weight:700;font-size:1.11rem;margin-bottom:2px}.user-step[_ngcontent-%COMP%]   .security-tips-card[_ngcontent-%COMP%]   .tips-desc[_ngcontent-%COMP%]{font-size:.99rem;color:#567;margin-bottom:10px}.user-step[_ngcontent-%COMP%]   .security-tips-card[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{border-radius:10px;padding:10px 14px;margin-bottom:7px;font-size:.96rem;line-height:1.45}.user-step[_ngcontent-%COMP%]   .security-tips-card[_ngcontent-%COMP%]   .tip.tip-green[_ngcontent-%COMP%]{background:#e7fceb;border-left:4px solid #6ec296}.user-step[_ngcontent-%COMP%]   .security-tips-card[_ngcontent-%COMP%]   .tip.tip-blue[_ngcontent-%COMP%]{background:#eaf5ff;border-left:4px solid #64b6f7}.user-step[_ngcontent-%COMP%]   .security-tips-card[_ngcontent-%COMP%]   .tip.tip-orange[_ngcontent-%COMP%]{background:#fff4e4;border-left:4px solid #f7b963}.user-step[_ngcontent-%COMP%]   .bottom-actions[_ngcontent-%COMP%]{margin-top:26px;display:flex;justify-content:space-between;gap:20px}"]})};export{me as UtilisateursComponent};
