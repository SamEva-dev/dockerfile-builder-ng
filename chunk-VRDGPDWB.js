import{b as ue}from"./chunk-MJQ3KY2W.js";import{a as ee,b as te,c as ne}from"./chunk-ZXMRF2QA.js";import"./chunk-NNZJJLOA.js";import{a as oe,b as re,c as le,d as me,e as de}from"./chunk-UHGY6NSJ.js";import{a as K,b as se}from"./chunk-YUABFYP2.js";import{c as Q,d as Y,e as J,f as Z,g as $,i as ie,j as pe,k as ae,l as ce}from"./chunk-X2UVP5SW.js";import"./chunk-G2M2UXHZ.js";import"./chunk-HEVQ3NIT.js";import"./chunk-Z7WK5Y2H.js";import{b as U}from"./chunk-6LZFZSYY.js";import{R as j,S as H,Ta as X,Ua as q,Va as G,h as N,i as A,l as z,w as L,x as W}from"./chunk-2ZZAZF3K.js";import{$ as x,$b as S,Bb as T,Cb as E,Eb as h,Gb as d,Hb as P,Ra as p,Tb as B,Wb as a,Xb as _,Zb as F,_b as w,a as f,ac as y,b as M,bb as I,bc as O,ec as R,fa as g,ga as C,gc as V,hb as v,jb as k,jc as l,kc as m,pa as D,ub as s,vb as i,wb as n,xb as b}from"./chunk-MXPEK2PN.js";var ge=()=>({label:"TCP",value:"TCP"}),Ce=()=>({label:"UDP",value:"UDP"}),Pe=(c,r)=>[c,r];function fe(c,r){if(c&1){let e=h();T(0),i(1,"div",24)(2,"mat-icon",25),a(3,"lan"),n(),i(4,"div",26),a(5),l(6,"translate"),n(),i(7,"p-button",27),l(8,"translate"),d("onClick",function(){g(e);let o=P();return C(o.addPort())}),n()(),E()}c&2&&(p(5),_(m(6,3,"PORTS.EMPTY")),p(2),s("label",O(m(8,5,"PORTS.ADD_FIRST"))))}function Me(c,r){if(c&1){let e=h();i(0,"p-card",30)(1,"div",31)(2,"span",32),a(3),l(4,"translate"),n(),i(5,"button",33),d("click",function(){let o=g(e).index,u=P(2);return C(u.removePort(o))}),n()(),i(6,"div",34)(7,"div",35)(8,"label"),a(9),l(10,"translate"),n(),i(11,"input",36),y("ngModelChange",function(o){let u=g(e).$implicit;return S(u.number,o)||(u.number=o),C(o)}),d("ngModelChange",function(){g(e);let o=P(2);return C(o.updateAllSignals())}),n()(),i(12,"div",35)(13,"label"),a(14),l(15,"translate"),n(),i(16,"p-select",37),y("ngModelChange",function(o){let u=g(e).$implicit;return S(u.protocol,o)||(u.protocol=o),C(o)}),d("ngModelChange",function(){g(e);let o=P(2);return C(o.updateAllSignals())}),n()()(),i(17,"div",35)(18,"label"),a(19),l(20,"translate"),n(),i(21,"input",38),y("ngModelChange",function(o){let u=g(e).$implicit;return S(u.description,o)||(u.description=o),C(o)}),d("ngModelChange",function(){g(e);let o=P(2);return C(o.updateAllSignals())}),n()()()}if(c&2){let e=r.$implicit,t=r.index;p(3),F("",m(4,9,"PORTS.PORT")," ",t+1),p(6),_(m(10,11,"PORTS.NUM")),p(2),w("ngModel",e.number),p(3),_(m(15,13,"PORTS.PROTOCOL")),p(2),s("options",V(19,Pe,R(17,ge),R(18,Ce))),w("ngModel",e.protocol),p(3),_(m(20,15,"PORTS.DESC")),p(2),w("ngModel",e.description)}}function be(c,r){if(c&1&&(T(0),i(1,"div",28),v(2,Me,22,22,"p-card",29),n(),E()),c&2){let e=P();p(2),s("ngForOf",e.ports())}}function Oe(c,r){if(c&1){let e=h();i(0,"button",39),d("click",function(){let o=g(e).$implicit,u=P();return C(u.addPort(o))}),i(1,"span",40),a(2),n(),i(3,"span",41),a(4),n()()}if(c&2){let e=r.$implicit,t=P();B("active",t.isCommonActive(e)),s("disabled",t.isCommonActive(e)),p(2),_(e.label),p(2),_(e.sub)}}var _e=class c{translate=x(L);dockerService=x(se);router=x(U);ports=D([]);commonPorts=[{label:"HTTP",sub:"HTTP",number:80,protocol:"TCP"},{label:"HTTPS",sub:"HTTPS",number:443,protocol:"TCP"},{label:"MySQL",sub:"Base de donn\xE9es",number:3306,protocol:"TCP"},{label:"PostgreSQL",sub:"Base de donn\xE9es",number:5432,protocol:"TCP"},{label:"Redis",sub:"Cache DB",number:6379,protocol:"TCP"},{label:"DNS",sub:"R\xE9solution DNS",number:53,protocol:"UDP"}];previous=new k;next=new k;dockerfilePreview=this.dockerService.dockerfilePreview;dockerComposePreview=this.dockerService.composePreview;dockerRunCommand=this.dockerService.cliPreview;addPort(r){r&&this.isCommonActive(r)||(this.ports.set([...this.ports(),r?{number:Number(r.number),protocol:r.protocol,description:r.sub,isCommon:!0}:{number:0,protocol:"TCP",description:""}]),this.updateAllSignals())}removePort(r){let e=[...this.ports()];e.splice(r,1),this.ports.set(e),this.updateAllSignals()}isCommonActive(r){return this.ports().some(e=>e.number===r.number&&e.protocol===r.protocol)}updateAllSignals(){let r=this.ports().map(e=>({published:e.number??0,target:e.number??0,protocol:e.protocol?.toLowerCase()}));this.generateFileFromInstructions(r),this.generateComposeFromInstructions(r),this.generateCommandFromInstructions(r)}generateFileFromInstructions(r){let e=this.dockerService.dockerfile();this.dockerService.updateDockerfile(M(f({},e||{}),{exposePorts:r}))}generateComposeFromInstructions(r){let e=this.dockerService.compose(),t=f({},e?.services||{});t.web=M(f({},t.web),{ports:r}),this.dockerService.updateCompose(M(f({},e||{}),{services:t}))}generateCommandFromInstructions(r){let e=this.dockerService.cli()||{},t=e.runCommands&&e.runCommands.length>0?e.runCommands.map(o=>M(f({},o),{ports:r})):[{ports:r}];this.dockerService.updateCLI(M(f({},e),{runCommands:t}))}onCopyDockerfile(){}onDownloadDockerfile(){}onPrevious(){this.previous.emit(),this.router.navigate(["/configuration"])}onNext(){this.updateAllSignals(),this.next.emit(),this.router.navigate(["/volumes"])}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=I({type:c,selectors:[["app-port-reseau"]],outputs:{previous:"previous",next:"next"},decls:59,vars:30,consts:[[1,"port-reseau-step"],[1,"step-content"],[1,"left-side"],[1,"section-card","expose-ports-card"],[1,"card-header"],[1,"mat-icon-bordered-outline"],[1,"title"],[1,"subtitle"],["icon","pi pi-plus","styleClass","p-button-primary",1,"add-btn","btn-blue-right",3,"onClick","label"],[4,"ngIf"],[1,"section-card","ports-communs-card"],[1,"ports-communs-header"],[1,"ports-communs-subtitle"],[1,"ports-communs-list"],["type","button","class","common-port-btn btn-blue-right",3,"active","disabled","click",4,"ngFor","ngForOf"],[1,"section-card","infos-reseau-card"],[1,"info","info-blue"],[1,"info","info-green"],[1,"info","info-orange"],[1,"bottom-actions"],["icon","pi pi-arrow-left","severity","secondary",1,"nav-btn","nav-btn-prev",3,"click","label"],["icon","pi pi-arrow-right","iconPos","right",1,"nav-btn","nav-btn-next","btn-blue-right",3,"click","label"],[1,"right-side"],[3,"copy","download","content"],[1,"init-content"],[1,"init-icon"],[1,"empty-msg"],["icon","pi pi-plus","styleClass","p-button-primary",1,"first-btn","btn-blue-right",3,"onClick","label"],[1,"ports-list"],["class","port-entry-card",4,"ngFor","ngForOf"],[1,"port-entry-card"],[1,"port-header"],[1,"port-tag"],["pButton","","pRipple","","type","button","icon","pi pi-trash","aria-label","Supprimer",1,"p-button-text","p-button-rounded","delete-btn",3,"click"],[1,"form-row"],[1,"form-group"],["pInputText","","placeholder","Port...","type","number",3,"ngModelChange","ngModel"],[3,"ngModelChange","options","ngModel"],["pInputText","","placeholder","Description",3,"ngModelChange","ngModel"],["type","button",1,"common-port-btn","btn-blue-right",3,"click","disabled"],[1,"label"],[1,"sub"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-card",3)(4,"div",4)(5,"div")(6,"mat-icon",5),a(7,"lan"),n(),i(8,"span",6),a(9),l(10,"translate"),n(),i(11,"div",7),a(12),l(13,"translate"),n()(),i(14,"p-button",8),l(15,"translate"),d("onClick",function(){return t.addPort()}),n()(),v(16,fe,9,7,"ng-container",9)(17,be,3,1,"ng-container",9),n(),i(18,"p-card",10)(19,"div",11),a(20),l(21,"translate"),n(),i(22,"div",12),a(23),l(24,"translate"),n(),i(25,"div",13),v(26,Oe,5,5,"button",14),n()(),i(27,"p-card",15)(28,"div",16)(29,"b"),a(30,"EXPOSE vs Port Publishing"),n(),b(31,"br"),a(32," EXPOSE documente les ports mais ne les publie pas."),b(33,"br"),a(34," Utilise "),i(35,"b"),a(36,"-p"),n(),a(37," lors de docker run pour les rendre accessibles. "),n(),i(38,"div",17)(39,"b"),a(40,"S\xE9curit\xE9"),n(),b(41,"br"),a(42," N\u2019expose que les ports n\xE9cessaires."),b(43,"br"),a(44," Utilisez des ports non privil\xE9gi\xE9s (> 1024) quand possible. "),n(),i(45,"div",18)(46,"b"),a(47,"Protocoles"),n(),b(48,"br"),a(49," TCP est le protocole par d\xE9faut. Sp\xE9cifiez UDP pour les services comme DNS ou streaming. "),n()(),i(50,"div",19)(51,"p-button",20),l(52,"translate"),d("click",function(){return t.onPrevious()}),n(),i(53,"p-button",21),l(54,"translate"),d("click",function(){return t.onNext()}),n()()(),i(55,"div",22)(56,"dockerfile-preview",23),d("copy",function(){return t.onCopyDockerfile()})("download",function(){return t.onDownloadDockerfile()}),n(),i(57,"docker-compose-preview",23),d("copy",function(){return t.onCopyDockerfile()})("download",function(){return t.onDownloadDockerfile()}),n(),i(58,"docker-command-preview",23),d("copy",function(){return t.onCopyDockerfile()})("download",function(){return t.onDownloadDockerfile()}),n()()()()),e&2&&(p(9),_(m(10,16,"PORTS.TITLE")),p(3),_(m(13,18,"PORTS.DESC")),p(2),s("label",O(m(15,20,"PORTS.ADD"))),p(2),s("ngIf",t.ports().length===0),p(),s("ngIf",t.ports().length>0),p(3),_(m(21,22,"PORTS.COMMONS")),p(3),_(m(24,24,"PORTS.COMMONS_SUB")),p(3),s("ngForOf",t.commonPorts),p(25),s("label",O(m(52,26,"COMMON.BACK_CONFIG"))),p(2),s("label",O(m(54,28,"COMMON.NEXT_VOLUMES"))),p(3),s("content",t.dockerfilePreview()),p(),s("content",t.dockerComposePreview()),p(),s("content",t.dockerRunCommand()))},dependencies:[z,N,A,H,j,K,ee,te,re,oe,ne,$,Q,Z,Y,J,ce,ae,pe,ie,G,X,q,ue,le,me,de,W],styles:[".port-reseau-step[_ngcontent-%COMP%]{width:100%;min-height:100vh;background:#f7fafd}.port-reseau-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]{display:flex;gap:30px;max-width:1200px;margin:0 auto;align-items:flex-start}@media (max-width: 1050px){.port-reseau-step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]{flex-direction:column}}.port-reseau-step[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]{flex:1.7;min-width:340px;max-width:540px;display:flex;flex-direction:column;gap:22px}.port-reseau-step[_ngcontent-%COMP%]   .right-side[_ngcontent-%COMP%]{flex:2.1;min-width:350px;max-width:650px;gap:10px}.port-reseau-step[_ngcontent-%COMP%]   .section-card[_ngcontent-%COMP%]{box-shadow:0 2px 12px #0077ee10;border-radius:14px;margin-bottom:0}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:8px 0 16px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.23rem;font-weight:700;margin-left:8px;color:#193f79}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1.01rem;color:#41689c;margin-left:44px;margin-top:-2px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%]{min-width:110px;margin-left:20px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .init-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:30px 0 20px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .init-content[_ngcontent-%COMP%]   .init-icon[_ngcontent-%COMP%]{font-size:2.8rem;color:#a3c0ea;margin-bottom:10px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .init-content[_ngcontent-%COMP%]   .empty-msg[_ngcontent-%COMP%]{font-size:1.13rem;color:#678;margin-bottom:18px;margin-top:2px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .init-content[_ngcontent-%COMP%]   .first-btn[_ngcontent-%COMP%]{min-width:270px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .ports-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .port-entry-card[_ngcontent-%COMP%]{background:#f7fafd;border-radius:10px;margin-bottom:0;padding:16px 14px 10px 16px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .port-entry-card[_ngcontent-%COMP%]   .port-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .port-entry-card[_ngcontent-%COMP%]   .port-header[_ngcontent-%COMP%]   .port-tag[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#1976d2;background:#e8f1fc;padding:3px 12px;border-radius:20px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .port-entry-card[_ngcontent-%COMP%]   .port-header[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{color:#de4343!important}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .port-entry-card[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;gap:16px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .port-entry-card[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:2px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .port-entry-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:8px}.port-reseau-step[_ngcontent-%COMP%]   .expose-ports-card[_ngcontent-%COMP%]   .port-entry-card[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;color:#123a66;margin-bottom:1px}.port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-header[_ngcontent-%COMP%]{font-weight:700;font-size:1.11rem;margin-bottom:2px}.port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-subtitle[_ngcontent-%COMP%]{font-size:.99rem;color:#567;margin-bottom:9px}.port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:11px;margin-top:2px}.port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-list[_ngcontent-%COMP%]   .common-port-btn[_ngcontent-%COMP%]{border:1px solid #c7dbf7;background:#e9f1fc;border-radius:13px;padding:8px 14px;min-width:110px;text-align:left;transition:background .2s,color .2s;cursor:pointer;display:flex;flex-direction:column}.port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-list[_ngcontent-%COMP%]   .common-port-btn[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:700;color:#226edb;font-size:1.03rem}.port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-list[_ngcontent-%COMP%]   .common-port-btn[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{font-size:.92em;color:#5a7bb6}.port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-list[_ngcontent-%COMP%]   .common-port-btn.active[_ngcontent-%COMP%], .port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-list[_ngcontent-%COMP%]   .common-port-btn[disabled][_ngcontent-%COMP%]{background:#c1d4f2;border-color:#92b4e7;color:#7f8c99;cursor:not-allowed}.port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-list[_ngcontent-%COMP%]   .common-port-btn.active[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-list[_ngcontent-%COMP%]   .common-port-btn[disabled][_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#7f8c99}.port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-list[_ngcontent-%COMP%]   .common-port-btn.active[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%], .port-reseau-step[_ngcontent-%COMP%]   .ports-communs-card[_ngcontent-%COMP%]   .ports-communs-list[_ngcontent-%COMP%]   .common-port-btn[disabled][_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{color:#b5b9be}.port-reseau-step[_ngcontent-%COMP%]   .infos-reseau-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{border-radius:10px;padding:12px 16px;margin-bottom:10px;font-size:.97rem;line-height:1.5}.port-reseau-step[_ngcontent-%COMP%]   .infos-reseau-card[_ngcontent-%COMP%]   .info.info-blue[_ngcontent-%COMP%]{background:#eaf5ff;border-left:4px solid #64b6f7}.port-reseau-step[_ngcontent-%COMP%]   .infos-reseau-card[_ngcontent-%COMP%]   .info.info-green[_ngcontent-%COMP%]{background:#e7fceb;border-left:4px solid #6ec296}.port-reseau-step[_ngcontent-%COMP%]   .infos-reseau-card[_ngcontent-%COMP%]   .info.info-orange[_ngcontent-%COMP%]{background:#fff4e4;border-left:4px solid #f7b963}.port-reseau-step[_ngcontent-%COMP%]   .bottom-actions[_ngcontent-%COMP%]{margin-top:24px;display:flex;justify-content:space-between;gap:20px}"],changeDetection:0})};export{_e as PortReseauComponent};
